<article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">API Implementation</h1><p class="post-meta post-meta-title"><time class="dt-published" datetime="2022-10-02T00:00:00-05:00" itemprop="datePublished">
        Oct 2, 2022
      </time>
       â€¢ <span class="read-time" title="Estimated read time">
    
    
      2 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/VSCodings/categories/#college board">college board</a>
        &nbsp;
      
        <a class="category-tags-link" href="/VSCodings/categories/#java">java</a>
        
      
      </p>
    

    
      
        <div class="pb-5 d-flex flex-justify-center">
          <div class="px-2">

    <a href="https://github.com/NicholasRamos5/VSCodings/tree/master/_notebooks/2022-10-02-API-Implementation.ipynb" role="button" target="_blank">
<img class="notebook-badge-image" src="/VSCodings/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div>

          <div class="px-2">
    <a href="https://mybinder.org/v2/gh/NicholasRamos5/VSCodings/master?filepath=_notebooks%2F2022-10-02-API-Implementation.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/VSCodings/assets/badges/binder.svg" alt="Open In Binder"/>
    </a>
</div>

          <div class="px-2">
    <a href="https://colab.research.google.com/github/NicholasRamos5/VSCodings/blob/master/_notebooks/2022-10-02-API-Implementation.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/VSCodings/assets/badges/colab.svg" alt="Open In Colab"/>
    </a>
</div>
          <div class="px-2">
  <a href="https://deepnote.com/launch?url=https%3A%2F%2Fgithub.com%2FNicholasRamos5%2FVSCodings%2Fblob%2Fmaster%2F_notebooks%2F2022-10-02-API-Implementation.ipynb" target="_blank">
      <img class="notebook-badge-image" src="/VSCodings/assets/badges/deepnote.svg" alt="Launch in Deepnote"/>
  </a>
</div>

        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul id="toc" class="section-nav">
<li class="toc-entry toc-h2"><a href="#Explanation">Explanation </a></li>
<li class="toc-entry toc-h2"><a href="#Build-a-Web-Service">Build a Web Service </a></li>
</ul><!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2022-10-02-API-Implementation.ipynb
-->

<div class="container" id="notebook-container">
        
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Explanation">
<a class="anchor" href="#Explanation" aria-hidden="true"><span class="octicon octicon-link"></span></a>Explanation<a class="anchor-link" href="#Explanation"> </a>
</h2>
<p>API's (Application Programming Interface) provide a way to store a large amount of data, and then allow you to access that data easily, without having to take it directly from another source. You can call API's in java and have that data be transferred. JSON is used to transmit this data. Since they're a massive data pool, you can easily take out data, allowing you to save time and code efficiently.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-java"><pre><span></span><span class="kn">import</span> <span class="nn">java.net.URI</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.net.http.HttpClient</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.net.http.HttpRequest</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.net.http.HttpResponse</span><span class="p">;</span>

<span class="n">HttpRequest</span> <span class="n">request</span> <span class="o">=</span> <span class="n">HttpRequest</span><span class="p">.</span><span class="na">newBuilder</span><span class="p">()</span>
		<span class="p">.</span><span class="na">uri</span><span class="p">(</span><span class="n">URI</span><span class="p">.</span><span class="na">create</span><span class="p">(</span><span class="s">"https://wft-geo-db.p.rapidapi.com/v1/geo/cities/Q65/locatedIn"</span><span class="p">))</span>
		<span class="p">.</span><span class="na">header</span><span class="p">(</span><span class="s">"X-RapidAPI-Key"</span><span class="p">,</span> <span class="s">"f4dbb6f12cmsh8393e3c31992857p1076ddjsnf78a3b66c369"</span><span class="p">)</span>
		<span class="p">.</span><span class="na">header</span><span class="p">(</span><span class="s">"X-RapidAPI-Host"</span><span class="p">,</span> <span class="s">"wft-geo-db.p.rapidapi.com"</span><span class="p">)</span>
		<span class="p">.</span><span class="na">method</span><span class="p">(</span><span class="s">"GET"</span><span class="p">,</span> <span class="n">HttpRequest</span><span class="p">.</span><span class="na">BodyPublishers</span><span class="p">.</span><span class="na">noBody</span><span class="p">())</span>
		<span class="p">.</span><span class="na">build</span><span class="p">();</span>
<span class="n">HttpResponse</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">response</span> <span class="o">=</span> <span class="n">HttpClient</span><span class="p">.</span><span class="na">newHttpClient</span><span class="p">().</span><span class="na">send</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">HttpResponse</span><span class="p">.</span><span class="na">BodyHandlers</span><span class="p">.</span><span class="na">ofString</span><span class="p">());</span>
<span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="na">body</span><span class="p">());</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>{"data":{"id":172136,"wikiDataId":"Q104994","type":"ADM2","city":"Los Angeles County","name":"Los Angeles County","country":"United States of America","countryCode":"US","region":"California","regionCode":"CA","elevationMeters":3,"latitude":34.05,"longitude":-118.25,"population":10014009,"timezone":"America__Los_Angeles","deleted":false}}
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Build-a-Web-Service">
<a class="anchor" href="#Build-a-Web-Service" aria-hidden="true"><span class="octicon octicon-link"></span></a>Build a Web Service<a class="anchor-link" href="#Build-a-Web-Service"> </a>
</h2>
<p>This code provides output with information on certain cities. In this case, we are looking at Los Angeles County. We have access to information about this city, such as country, region, elevation, latitude, and population.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-java"><pre><span></span><span class="kn">import</span> <span class="nn">java.net.URI</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.net.http.HttpClient</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.net.http.HttpRequest</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.net.http.HttpResponse</span><span class="p">;</span>

<span class="n">HttpRequest</span> <span class="n">request</span> <span class="o">=</span> <span class="n">HttpRequest</span><span class="p">.</span><span class="na">newBuilder</span><span class="p">()</span>
		<span class="p">.</span><span class="na">uri</span><span class="p">(</span><span class="n">URI</span><span class="p">.</span><span class="na">create</span><span class="p">(</span><span class="s">"https://wft-geo-db.p.rapidapi.com/v1/geo/cities/Q65/locatedIn"</span><span class="p">))</span>
		<span class="p">.</span><span class="na">header</span><span class="p">(</span><span class="s">"X-RapidAPI-Key"</span><span class="p">,</span> <span class="s">"f4dbb6f12cmsh8393e3c31992857p1076ddjsnf78a3b66c369"</span><span class="p">)</span>
		<span class="p">.</span><span class="na">header</span><span class="p">(</span><span class="s">"X-RapidAPI-Host"</span><span class="p">,</span> <span class="s">"wft-geo-db.p.rapidapi.com"</span><span class="p">)</span>
		<span class="p">.</span><span class="na">method</span><span class="p">(</span><span class="s">"GET"</span><span class="p">,</span> <span class="n">HttpRequest</span><span class="p">.</span><span class="na">BodyPublishers</span><span class="p">.</span><span class="na">noBody</span><span class="p">())</span>
		<span class="p">.</span><span class="na">build</span><span class="p">();</span>
<span class="n">HttpResponse</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">response</span> <span class="o">=</span> <span class="n">HttpClient</span><span class="p">.</span><span class="na">newHttpClient</span><span class="p">().</span><span class="na">send</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">HttpResponse</span><span class="p">.</span><span class="na">BodyHandlers</span><span class="p">.</span><span class="na">ofString</span><span class="p">());</span>
<span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="na">body</span><span class="p">());</span>

<span class="kn">import</span> <span class="nn">java.net.URI</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.net.http.HttpClient</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.net.http.HttpRequest</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.net.http.HttpResponse</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.util.Date</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.util.HashMap</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">org.json.simple.JSONObject</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.json.simple.parser.JSONParser</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.http.HttpStatus</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.http.ResponseEntity</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.*</span><span class="p">;</span>

<span class="nd">@RestController</span> <span class="c1">// annotation to create a RESTful web services</span>
<span class="nd">@RequestMapping</span><span class="p">(</span><span class="s">"/api/geodb-cities"</span><span class="p">)</span>  <span class="c1">//prefix of API</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">CovidApiController</span> <span class="p">{</span>
    <span class="kd">private</span> <span class="n">JSONObject</span> <span class="n">body</span><span class="p">;</span> <span class="c1">//last run result</span>
    <span class="kd">private</span> <span class="n">HttpStatus</span> <span class="n">status</span><span class="p">;</span> <span class="c1">//last run status</span>
    <span class="n">String</span> <span class="n">last_run</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span> <span class="c1">//last run day of month</span>

    <span class="c1">// GET Covid 19 Stats</span>
    <span class="nd">@GetMapping</span><span class="p">(</span><span class="s">"/daily"</span><span class="p">)</span>   <span class="c1">//added to end of prefix as endpoint</span>
    <span class="kd">public</span> <span class="n">ResponseEntity</span><span class="o">&lt;</span><span class="n">JSONObject</span><span class="o">&gt;</span> <span class="nf">getGeo</span><span class="p">()</span> <span class="p">{</span>

        <span class="c1">//calls API once a day, sets body and status properties</span>
        <span class="n">String</span> <span class="n">today</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Date</span><span class="p">().</span><span class="na">toString</span><span class="p">().</span><span class="na">substring</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">);</span> 
        <span class="k">if</span> <span class="p">(</span><span class="n">last_run</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">||</span> <span class="o">!</span><span class="n">today</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="n">last_run</span><span class="p">))</span>
        <span class="p">{</span>
            <span class="k">try</span> <span class="p">{</span>  <span class="c1">//APIs can fail (ie Internet or Service down)</span>

                <span class="c1">//RapidAPI header</span>
                <span class="n">HttpRequest</span> <span class="n">request</span> <span class="o">=</span> <span class="n">HttpRequest</span><span class="p">.</span><span class="na">newBuilder</span><span class="p">()</span>
		            <span class="p">.</span><span class="na">uri</span><span class="p">(</span><span class="n">URI</span><span class="p">.</span><span class="na">create</span><span class="p">(</span><span class="s">"https://wft-geo-db.p.rapidapi.com/v1/geo/cities/Q65/locatedIn"</span><span class="p">))</span>
		            <span class="p">.</span><span class="na">header</span><span class="p">(</span><span class="s">"X-RapidAPI-Key"</span><span class="p">,</span> <span class="s">"f4dbb6f12cmsh8393e3c31992857p1076ddjsnf78a3b66c369"</span><span class="p">)</span>
		            <span class="p">.</span><span class="na">header</span><span class="p">(</span><span class="s">"X-RapidAPI-Host"</span><span class="p">,</span> <span class="s">"wft-geo-db.p.rapidapi.com"</span><span class="p">)</span>
		            <span class="p">.</span><span class="na">method</span><span class="p">(</span><span class="s">"GET"</span><span class="p">,</span> <span class="n">HttpRequest</span><span class="p">.</span><span class="na">BodyPublishers</span><span class="p">.</span><span class="na">noBody</span><span class="p">())</span>
		            <span class="p">.</span><span class="na">build</span><span class="p">();</span>

                <span class="c1">//RapidAPI request and response</span>
                <span class="n">HttpResponse</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">response</span> <span class="o">=</span> <span class="n">HttpClient</span><span class="p">.</span><span class="na">newHttpClient</span><span class="p">().</span><span class="na">send</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">HttpResponse</span><span class="p">.</span><span class="na">BodyHandlers</span><span class="p">.</span><span class="na">ofString</span><span class="p">());</span>

                <span class="c1">//JSONParser extracts text body and parses to JSONObject</span>
                <span class="k">this</span><span class="p">.</span><span class="na">body</span> <span class="o">=</span> <span class="p">(</span><span class="n">JSONObject</span><span class="p">)</span> <span class="k">new</span> <span class="n">JSONParser</span><span class="p">().</span><span class="na">parse</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="na">body</span><span class="p">());</span>
                <span class="k">this</span><span class="p">.</span><span class="na">status</span> <span class="o">=</span> <span class="n">HttpStatus</span><span class="p">.</span><span class="na">OK</span><span class="p">;</span>  <span class="c1">//200 success</span>
                <span class="k">this</span><span class="p">.</span><span class="na">last_run</span> <span class="o">=</span> <span class="n">today</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">catch</span> <span class="p">(</span><span class="n">Exception</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>  <span class="c1">//capture failure info</span>
                <span class="n">HashMap</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span> <span class="n">String</span><span class="o">&gt;</span> <span class="n">status</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;&gt;</span><span class="p">();</span>
                <span class="n">status</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="s">"status"</span><span class="p">,</span> <span class="s">"RapidApi failure: "</span> <span class="o">+</span> <span class="n">e</span><span class="p">);</span>

                <span class="c1">//Setup object for error</span>
                <span class="k">this</span><span class="p">.</span><span class="na">body</span> <span class="o">=</span> <span class="p">(</span><span class="n">JSONObject</span><span class="p">)</span> <span class="n">status</span><span class="p">;</span>
                <span class="k">this</span><span class="p">.</span><span class="na">status</span> <span class="o">=</span> <span class="n">HttpStatus</span><span class="p">.</span><span class="na">INTERNAL_SERVER_ERROR</span><span class="p">;</span> <span class="c1">//500 error</span>
                <span class="k">this</span><span class="p">.</span><span class="na">last_run</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="c1">//return JSONObject in RESTful style</span>
        <span class="k">return</span> <span class="k">new</span> <span class="n">ResponseEntity</span><span class="o">&lt;&gt;</span><span class="p">(</span><span class="n">body</span><span class="p">,</span> <span class="n">status</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>{"data":{"id":172136,"wikiDataId":"Q104994","type":"ADM2","city":"Los Angeles County","name":"Los Angeles County","country":"United States of America","countryCode":"US","region":"California","regionCode":"CA","elevationMeters":3,"latitude":34.05,"longitude":-118.25,"population":10014009,"timezone":"America__Los_Angeles","deleted":false}}
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-black-intense-fg ansi-bold">|   </span><span class="ansi-black-intense-fg ansi-bold">import </span><span class="ansi-black-intense-fg ansi-red-bg ansi-bold">org.json.simple.JSONObject</span><span class="ansi-black-intense-fg ansi-bold">;</span>
<span class="ansi-red-intense-fg ansi-bold">package org.json.simple does not exist</span>
</pre>
</div>
</div>

</div>
</div>

</div>
    

</div>



  </div><!-- from https://github.com/utterance/utterances -->
<script src="https://utteranc.es/client.js"
        repo="NicholasRamos5/VSCodings"
        issue-term="title"
        label="blogpost-comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script><a class="u-url" href="/VSCodings/college%20board/java/2022/10/02/API-Implementation.html" hidden></a>
</article>
